name: 01. ğŸŸ¢ app_baidu2douyin

on:
  # å½“æŒ‰è®¡åˆ’ï¼ˆæˆ–æŒ‰æ¨/æ‹‰ï¼‰è§¦å‘å…·æœ‰è¾“å…¥çš„å·¥ä½œæµæ—¶ï¼Œæ‰€æœ‰è¾“å…¥å€¼å‡ä¸ºç©ºï¼Œéœ€è¦è‡ªå·±è®¾ç½®å¥½é»˜è®¤å€¼
  schedule:
    # æ—¶é—´ +8 å°±æ˜¯åŒ—äº¬æ—¶é—´
    - cron: "00 21 * * *"

  workflow_dispatch:
    inputs:
      ARGS:
        description: |
          -n NUM, --num NUM
             å‘å¸ƒ N å¤©çš„è§†é¢‘

          -d, --debug
             è°ƒè¯•ï¼Œä¼šæ‹·è´ mypy/tools ä¸‹çš„ cookies è¿‡æ¥
        required: false
        type: string
        # å¦‚æœè¦ä¼ å…¥æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨åŒå¼•å·æ‹¬èµ·æ¥è¾“å…¥ "-m once"
        # è¿™ç§æ–¹å¼å°±åƒç»ˆç«¯è¾“å…¥å‘½ä»¤ä¸€æ ·çš„
        default: "-d -n 1"

      ENV_PUBLISH_ACCOUNT:
        type: choice
        description: "é€‰æ‹©è´¦å·"
        required: false
        default: "middle"
        # ä¸ constants.py/Account ä¸€ä¸€å¯¹åº”
        options:
          - "large" # å¤§å·
          - "middle" # ä¸­å·
          - "test" # æµ‹è¯•è´¦å·

      ENV_AIGC_TYPE:
        type: choice
        # å®šä¹‰åœ¨ const.py/FILE_TYPE_PPT
        description: "AI ç”Ÿæˆå†…å®¹ç±»å‹"
        required: false
        default: "ppt"
        options:
          - "ppt"
          - "doc"

      ENV_PUBLISH_MEDIA_TYPE:
        type: choice
        # å®šä¹‰åœ¨ const.py/MEDIA_TYPE_IMG_ARTICLE
        description: "å‘å¸ƒåª’ä½“ç±»å‹"
        required: false
        default: "video"
        options:
          - "video" # è§†é¢‘
          - "image_article" # å›¾æ–‡

      # github action è¿˜ä¸æ”¯æŒå¤é€‰æ¡†
      ENV_PUBLISH_PLATFORMS:
        type: string
        description: "é€‰æ‹©å‘å¸ƒå¹³å°ï¼Œç”¨ ',' åˆ†å‰²ï¼ˆä¸å¸¦ç©ºæ ¼ï¼Œå¯é€‰é¡¹: douyin,wechat,xiaohongshuï¼‰"
        required: false
        default: "douyin"

      ENV_PUBLISH_MOD:
        type: choice
        description: "é€‰æ‹©å‘å¸ƒæ—¶é—´æ¨¡å¼"
        required: false
        default: "timing"
        options:
          - "now"
          - "timing"

      REF:
        description: "åˆ†æ”¯æˆ–æ ‡ç­¾ã€æäº¤ID"
        type: choice
        required: false
        options:
          - "master"
          - "release"

jobs:
  run_app:
    uses: wordsworth-mk/github-runner/.github/workflows/21.run.yml@main
    with:
      # æ— æ³•é€šè¿‡è°ƒç”¨æ–¹å®šä¹‰ç¯å¢ƒå˜é‡ï¼Œåªèƒ½é€šè¿‡ with ä¼ é€’ input å‚æ•°è¿›å»äº†
      # æ³¨æ„ï¼Œæ–°å¢å˜é‡çš„è¯ï¼Œéœ€è¦åœ¨ run.yaml ä¸­è¿›è¡Œå®šä¹‰
      ENV_PUBLISH_MOD: ${{ github.event.inputs.ENV_PUBLISH_MOD }}
      ENV_PUBLISH_PLATFORMS: ${{ github.event.inputs.ENV_PUBLISH_PLATFORMS }}
      ENV_PUBLISH_MEDIA_TYPE: ${{ github.event.inputs.ENV_PUBLISH_MEDIA_TYPE }}
      ENV_PUBLISH_ACCOUNT: ${{ github.event.inputs.ENV_PUBLISH_ACCOUNT }}
      ENV_AIGC_TYPE: ${{ github.event.inputs.ENV_AIGC_TYPE }}

      APP: baidu2douyin
      # å®šæ—¶ä»»åŠ¡æ²¡åŠæ³•ç»™å‚æ•°ï¼Œåªèƒ½åœ¨è¿™é‡Œé…ç½®é»˜è®¤å€¼äº†
      ARGS: ${{ inputs.ARGS || '-d -n 1' }}
      REF: ${{ inputs.REF }}

    secrets:
      MYPY_ACCESS_TOKEN: ${{ secrets.MYPY_ACCESS_TOKEN }}
