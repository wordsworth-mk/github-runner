name: 99. ğŸ‰ ssh-by-vscode

on:
  workflow_dispatch:
    inputs:
      REPOSITORY:
        type: string
        default: M-Kepler/Golang
        description: "ä»£ç ä»“åº“"
        required: false

jobs:
  ssh-by-vscode:
    runs-on: ubuntu-latest
    steps:
      - name: åˆ›å»ºè½¯é“¾
        continue-on-error: true
        run: |
          ln -s $GITHUB_WORKSPACE ~/workspace

      - name: è®¾ç½®æ—¶åŒº
        uses: szenius/set-timezone@v2.0
        with:
          timezoneLinux: "Asia/Shanghai"
          timezoneWindows: "China Standard Time"

      - name: é…ç½® SSH key
        # https://stackoverflow.com/questions/75578151/how-do-i-clone-a-repo-in-b-repo-github-actions-if-two-repo-is-in-same-organizati
        # NOTICE: ä¹Ÿå¯ä»¥æ‰‹åŠ¨åœ¨ github actions é‡Œæ‹‰å–ï¼Œä¸è¿‡è¦ç”¨ https åè®®ï¼Œè€Œä¸”æäº¤çš„æ—¶å€™éœ€è¦è¿›è¡Œè´¦å¯†è®¤è¯
        # è€Œé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿™ä¸éœ€è¦è´¦å¯†è®¤è¯
        uses: shimataro/ssh-key-action@v2
        with:
          key: ${{ secrets.SSH_KEY }}
          name: id_rsa
          known_hosts: "github.com" # ${{ secrets.KNOWN_HOSTS }}
          if_key_exists: fail # replace / ignore / fail; optional (defaults to fail)

      - name: é…ç½® git è´¦å·
        run: |
          git config --global user.name "actions-user"
          git config --global user.email "actions-user@github.com"
          git config --global --list

      - name: è®¾ç½®è¿è¡Œç¯å¢ƒé…ç½®
        continue-on-error: true
        run: |
          git clone git@github.com:M-Kepler/dotfiles ~/dotfiles
          cd ~/dotfiles
          bash run.sh

      - name: æ‹‰å–ä»£ç 
        run: |
          git clone git@github.com:${{ inputs.REPOSITORY }}

      - name: é€šè¿‡ vscode è¿æ¥åˆ° github action
        uses: fawazahmed0/action-debug-vscode@main
