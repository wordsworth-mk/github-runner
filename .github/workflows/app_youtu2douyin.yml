name: ğŸŸ¢ app_youtu2douyin

on:
  # # å®šæ—¶æ‰§è¡Œ
  # schedule:
  #   # ä»£è¡¨å›½é™…æ ‡å‡†æ—¶é—´ï¼Œå®é™…åŒ—äº¬æ—¶é—´éœ€è¦ +8 å°æ—¶
  #   - cron: "30 13 * * *"

  workflow_dispatch:
    inputs:
      ARGS:
        description: |
          -m {loop,once,manual}
             è¿è¡Œæ¨¡å¼, -m loop è¡¨ç¤ºæŒç»­ç›‘æ§; -m once è¡¨ç¤ºè¿è¡Œä¸€æ¬¡; -m manual è¡¨ç¤ºæ‰‹åŠ¨è§¦å‘

          -t {channel,playlist}
             è§†é¢‘åˆé›†ç±»å‹(channel/playlist)

          --publish
            æ‰§è¡Œå‘å¸ƒæ“ä½œï¼ˆé»˜è®¤å‘å¸ƒï¼‰

          --no-publish
            ä¸æ‰§è¡Œå‘å¸ƒæ“ä½œ

          -f
            ä¸ç®¡æ˜¯å¦å·²ç»å‘å¸ƒè¿‡ï¼Œéƒ½å¼ºåˆ¶å‘å¸ƒè¯¥è§†é¢‘

        required: false
        type: string
        # å¦‚æœè¦ä¼ å…¥æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨åŒå¼•å·æ‹¬èµ·æ¥è¾“å…¥ "-m once"
        # è¿™ç§æ–¹å¼å°±åƒç»ˆç«¯è¾“å…¥å‘½ä»¤ä¸€æ ·çš„
        default: "-m manual "

      # github action è¿˜ä¸æ”¯æŒå¤é€‰æ¡†
      ENV_PUBLISH_PLATFORMS:
        type: string
        description: "é€‰æ‹©å‘å¸ƒå¹³å°ï¼Œç”¨ ',' åˆ†å‰²ï¼ˆä¸å¸¦ç©ºæ ¼ï¼Œå¯é€‰é¡¹: douyin,wechat,xiaohongshuï¼‰"
        required: false
        default: "douyin,wechat"

      ENV_PUBLISH_MOD:
        type: choice
        description: "é€‰æ‹©å‘å¸ƒæ—¶é—´æ¨¡å¼"
        required: false
        default: "timing"
        options:
          - "now"
          - "timing"

      ENV_DOUYIN_PUBLISH_ACCOUNT:
        type: choice
        description: "é€‰æ‹©æŠ–éŸ³è´¦å·"
        required: false
        default: "large"
        options:
          - "large" # å¤§å·
          - "middle" # ä¸­å·
          - "test" # æµ‹è¯•è´¦å·

env:
  # æŠŠ github action çš„ input è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­
  ENV_PUBLISH_MOD: ${{ github.event.inputs.ENV_PUBLISH_MOD }}
  ENV_PUBLISH_PLATFORMS: ${{ github.event.inputs.ENV_PUBLISH_PLATFORMS }}
  ENV_DOUYIN_PUBLISH_ACCOUNT: ${{ github.event.inputs.ENV_DOUYIN_PUBLISH_ACCOUNT }}

jobs:
  run:
    uses: wordsworth-mk/github-runner/.github/workflows/run.yml@main
    with:
      APP: youtu2douyin
      # å®šæ—¶æ‰§è¡Œæ²¡ä¼ è¿™ä¸ªå€¼ä¹Ÿå¯ä»¥ï¼Œåœ¨ run.yml å·²ç»åšäº†å¤„ç†äº†
      ARGS: ${{ inputs.ARGS }}
      DEPENDENT_BINARY: "ffmpeg"
      FORCE_COMMIT: true
    secrets:
      MYPY_ACCESS_TOKEN: ${{ secrets.MYPY_ACCESS_TOKEN }}
