name: ğŸŸ¢ app_baidu2douyin

on:
  workflow_dispatch:
    inputs:
      ARGS:
        description: |
          -m {auto,manual}, --mode {auto,manual}
             è¿è¡Œæ¨¡å¼, -m auto è¡¨ç¤ºè‡ªåŠ¨è¿è¡Œ; -m manural è¡¨ç¤ºäº¤äº’æ¨¡å¼

          -n NUM, --num NUM
             å‘å¸ƒ N å¤©çš„è§†é¢‘

          -d, --debug
             è°ƒè¯•ï¼Œä¼šæ‹·è´ mypy/tools ä¸‹çš„é…ç½®è¿‡æ¥
        required: false
        type: string
        # å¦‚æœè¦ä¼ å…¥æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨åŒå¼•å·æ‹¬èµ·æ¥è¾“å…¥ "-m once"
        # è¿™ç§æ–¹å¼å°±åƒç»ˆç«¯è¾“å…¥å‘½ä»¤ä¸€æ ·çš„
        default: "-n 2 -d"
  schedule:
    # æ¯ä¸ªæœˆ 1 å·å’Œ 15 å·æ‰§è¡Œ
    - cron: "30 13 1,15 * *"

env:
  IN_GITHUBACTION: true

jobs:

  set_run_env:
    runs-on: ubuntu-latest
    outputs:
      env_var: ${{ env.IN_GITHUBACTION }}
    steps:
      - name: Set Env
        env:
          IN_GITHUBACTION: true
        run: echo "::set-output name=env_var::$IN_GITHUBACTION"

  run_app:
    needs: [set_run_env]
    uses: wordsworth-mk/github-runner/.github/workflows/run.yml@main
    with:
      APP: baidu2douyin
      ARGS: ${{ inputs.ARGS }}
    secrets:
      MYPY_ACCESS_TOKEN: ${{ secrets.MYPY_ACCESS_TOKEN }}